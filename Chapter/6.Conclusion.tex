% !TEX root = ../MasterThesis_Onoe.tex
% 上記はただのコメントではなく親ファイルの場所を教えているので
% 消してしまうとファイルごとのタイプセットができなくなるので注意。
% 親ファイル名を変更したときはここも変更する。

\chapter{まとめと今後の展望} \label{sec:Conclusion}
本論文では、電子陽電子ヒッグスファクトリーのためのジェット測定技術の研究として、特にILCを念頭に置いた2つのテーマの研究を行った。1つ目のテーマでは、ILCの検出器案であるILDの電磁カロリメータのうち、SiW-ECALの技術プロトタイプをハドロンビーム試験によって性能評価した。2つ目のテーマでは、深層学習を用いたフレーバー識別アルゴリズムの開発を行った。本章ではそれぞれの研究のまとめと今後の展望について述べる。
\subsection*{ILD Si-W ECAL プロトタイプのハドロンビーム試験による性能評価}
解析が完了次第記入

\subsection*{深層学習を用いたフレーバー識別アルゴリズム}
本研究では、深層学習を用いたフレーバー識別アルゴリズムの開発を行った。ヒッグスファクトリーの目的であるヒッグス粒子は、クォークやグルーオンなどに崩壊し、多数のハドロンの束であるジェットとして検出器に到達する。そのためジェットの再構成でクォークのフレーバーを識別することは、ヒッグスの物理を知るための解析において非常に重要な情報となる。フレーバー識別はジェットの構成粒子の種類や運動量、崩壊点に関する情報から、ジェットの元となるクォークのフレーバーを識別するプロセスであり、現在ジェットの再構成に用いられているLCFIPlusでは従来の機械学習手法であるBDTsが用いられている。これに対して深層学習を導入することで、識別性能の向上や崩壊点検出アルゴリズムとの統合などを目指した。\\
　はじめに、最も単純な構造のネットワークモデルであるディープニューラルネットワークによる実装を行った。アルゴリズムには過学習対策や学習の効率化に向けた手法を用いて、全結合層を中心としたディープニューラルネットワークのモデルを、PyTorchを用いて構築した。学習の入力データとして、$\SI{250}{GeV}$のILDフルシミュレーションのイベント400万イベントを、変数にはBDTsの学習に用いた変数と同じものを用いた。学習を重ねるにつれて損失は減少し、学習全体の精度はおよそ82.5\%で得られた。またLCFIPlusとの比較にあたっては、識別効率あたりの誤認率によって比較した。結果として、cジェットの識別など一部で改善が見られたものの、LCFIPlusと大差ない、あるいはやや劣る結果となった。\\
　続いて、グラフデータを用いたフレーバー識別アルゴリズムの実装を行った。動機としては、フレーバー識別において重要なIP付近の物理現象をグラフ構造のデータとして構築することで、物理量を羅列する1次元の数値データと比較して表現力が上がり、性能が向上するのではないかという狙いがあった。またグラフデータを構築する際の副産物として、以前は別プロセスであった崩壊点検出を1回の識別で同時に処理できるという長所もあった。グラフデータは独自のデータセットクラスを作成し、飛跡をノードとする全結合のグラフを、1ジェットあたり1グラフ構築した。また、このグラフではディープニューラルネットワークと異なり、ノードのみ飛跡再構成におけるフィッティングパラメータを特徴量を持つとした。イベントは$\SI{250}{GeV}$のILDフルシミュレーションのイベント240万イベントを用いた。ネットワークアルゴリズムはGATを3層使用し、損失関数の工夫やデータ次元変更などの手法を用いてノード識別/リンク予測/グラフ分類の3つのタスクを同時に実行し、重みを共有するようなネットワークモデルをPyTorch Geometricを用いて実装した。学習は不安定であったものの損失は減少し、ディープニューラルネットワークに匹敵するグラフ分類の精度が得られた。また識別効率あたりの誤認率のプロットによるLCFIPlusとの比較では、bジェット識別において改善が見られたが、cジェット識別では非常に悪い結果となった。またノード識別、リンク予測に対しては十分に良い精度を得ることができなかった。しかし、低い精度ながら崩壊点検出アルゴリズムの統合を達成することができた。\\
\hfill
今後の展望として、フレーバー識別アルゴリズムには大きく2つの方向性で改善が可能であると考えている。\\
1つ目は深層学習の理論・技術面での方向性である。GATに挙げられるネットワークの処理に関してより理解を深め、フレーバー識別により最適なネットワーク構造を提案することや、物理的な性質をより組み込むなどフレーバー識別に最適化された損失関数を設計するなど、演算手法によって更なる改善の見込みがあると考えている。また、グラフデータの設計についても改善ができると考えており、具体例としては今回のデータセットにおいて崩壊点となるエッジに特徴量を持たせることや、グラフデータの構成要素を変更することなどが挙げられる。現在エッジは特徴量を持っておらず、接続したノードの情報のみで更新を行っているが、エッジ自身が特徴量を持つことでデータの学習パラメータが増え、精度が向上すると考えることができる。また、本研究では飛跡をノードとするグラフを構成したが、本来飛跡は点ではなく曲線の形状を取るため、やはり崩壊点のような物理的に点となる量をノードとすることで、実際の物理現象に近いグラフの構築が期待できると考えている。\\
2つ目は、iLCSoftとしての実装に向けた方向性である。例えば出力情報の設計やC++環境への移行があると考えている。出力設計に関して、今回のグラフデータを用いたフレーバー識別では崩壊点検出を包含するアルゴリズムを開発した。しかし、現段階では解析において崩壊点の情報が必要になった際、物理量として出力することは出来ない。そのため方針としては、中間層で得たネットワークの潜在的なパラメータを回帰問題として設計することで、新しく崩壊点など数値データの出力を得ることなどが考えられる。また別の例としては、開発したフレーバー識別アルゴリズムのC++環境への移植である。現在ジェット再構成に用いられているLCFIPlusはMarlinプロセッサーの1部であり、C++環境で動作している一方で、本研究で開発したアルゴリズムはpythonによって記述されている。そのためPyTorch/PyTorch Geometrc C++ APIを用いる、あるいはC++によって書き換えを行うことによるiLCSoftへの実装は、今後の課題の一つである。\\
